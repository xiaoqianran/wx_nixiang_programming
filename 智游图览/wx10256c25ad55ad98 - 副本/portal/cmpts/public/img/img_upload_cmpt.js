var e=require("../../../../@babel/runtime/helpers/regeneratorRuntime"),t=require("../../../../@babel/runtime/helpers/asyncToGenerator"),a=require("../../../helper/page_helper.js"),i=require("../../../helper/content_check_helper.js"),r=require("../../../setting/setting.js");Component({properties:{imgList:{type:Array,value:[]},imgMax:{type:Number,value:4},title:{type:String,value:"图片上传"},must:{type:Boolean,value:!0},isCheck:{type:Boolean,value:!0},isShowNo:{type:Boolean,value:!1},imgUploadSize:{type:Number,value:r.IMG_UPLOAD_SIZE},isShowSize:{type:Boolean,value:!0}},data:{},lifetimes:{attached:function(){},ready:function(){},detached:function(){}},methods:{bindChooseImgTap:function(r){var n,s=this;wx.chooseMedia({count:this.data.imgMax-this.data.imgList.length,mediaType:["image"],sizeType:["compressed"],sourceType:["album","camera"],success:(n=t(e().mark((function t(r){var n,o,u,c;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:wx.showLoading({title:"图片校验中",mask:!0}),n=0;case 2:if(!(n<r.tempFiles.length)){e.next=24;break}if(o=r.tempFiles[n].size,u=r.tempFiles[n].tempFilePath,i.imgTypeCheck(u)){e.next=8;break}return wx.hideLoading(),e.abrupt("return",a.showNoneToast("只能上传png、jpg、jpeg格式",3e3));case 8:if(c=1024e3*s.data.imgUploadSize,i.imgSizeCheck(o,c)){e.next=12;break}return wx.hideLoading(),e.abrupt("return",a.showNoneToast("单张图片大小不能超过 "+s.data.imgUploadSize+"M",3e3));case 12:if(!s.data.isCheck){e.next=19;break}return e.next=15,i.imgCheck(u);case 15:if(e.sent){e.next=19;break}return wx.hideLoading(),e.abrupt("return",a.showNoneToast("存在不合适的图片, 已屏蔽",3e3));case 19:s.setData({imgList:s.data.imgList.concat(u)}),s.triggerEvent("upload",s.data.imgList);case 21:n++,e.next=2;break;case 24:wx.hideLoading();case 25:case"end":return e.stop()}}),t)}))),function(e){return n.apply(this,arguments)})})},bindPreviewImgTap:function(e){wx.previewImage({urls:this.data.imgList,current:e.currentTarget.dataset.url})},catchDelImgTap:function(e){var t=this;a.showConfirm("确定要删除该图片吗？",(function(){t.data.imgList.splice(e.currentTarget.dataset.index,1),t.setData({imgList:t.data.imgList}),t.triggerEvent("upload",t.data.imgList)}))}}});