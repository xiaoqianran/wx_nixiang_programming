var t=require("../../../../helper/data_helper.js"),e=require("../../../../helper/page_helper.js"),a=require("../../../../helper/time_helper.js");Component({options:{addGlobalClass:!0},properties:{day:{type:String,value:""},startTimeStep:{type:Number,value:0},endTimeStep:{type:String,value:47},used:{type:Array,value:[]},usedPos:{type:String,value:"first"}},data:{times:[],selectedStart:"",selectedEnd:"",selectedEndPoint:""},lifetimes:{attached:function(){},ready:function(){this.init()},detached:function(){}},methods:{init:function(){var e=a.time("Y-M-D h:m"),s=this.data.times,d=this.data.day;if(d||(d=a.time("Y-M-D")),this.setData({day:d}),0==s)for(var r=this.data.startTimeStep;r<=this.data.endTimeStep;r++){var i="",n="",l="",h=Math.trunc(r/2);r%2==0?(i=t.padLeft(h,2,"0")+":00",n=t.padLeft(h,2,"0")+":30",l=i):(i=t.padLeft(h,2,"0")+":30",n=t.padLeft(h+1,2,"0")+":00",l=""),"24:00"==n&&(n="23:59");var u={idx:r,title:l,start:i,end:n,used:!1,selected:!1,expire:d+" "+i<e};s.push(u)}for(var o=0;o<this.data.used.length;o++){for(var p=this.data.used[o],c=0,f=0;f<s.length;f++){var v=s[f];v.start>=p.start&&v.start<=p.end&&c++}c<=1&&(c=2),c=Math.round(c/2),"first"==this.data.usedPos&&(c=1);for(var m=0,S=0;S<s.length;S++){var g=s[S];g.start==p.start?(g.used=p.url||"no",g.usedFirst=!0,++m==c&&(g.usedText=p.title)):g.start>=p.start&&g.start<=p.end&&(g.used=p.url||"no",g.usedFirst=!1,++m==c&&(g.usedText=p.title))}}this.setData({times:s})},bindSelectTap:function(t){var a=e.dataset(t,"idx"),s=this.data.times[a],d=s.start,r=s.used;if(r)return!0===r?void 0:wx.navigateTo({url:r});if(!s.expire){var i=this.data.selectedStart,n=this.data.selectedEnd,l=this.data.times;if(d>=i&&d<=n){i="",n="";for(var h=0;h<l.length;h++)l[h].selected=!1;this.setData({times:l,selectedStart:i,selectedEnd:n})}else{i||n||(i=d,n=d),d<i&&(i=d),d>n&&(n=d);for(var u=0;u<l.length;u++)l[u].start>=i&&l[u].start<=n&&(l[u].selected=!0);for(var o="",p=0;p<l.length;p++)l[p].start==n&&(o=l[p].end);this.setData({times:l,selectedStart:i,selectedEnd:n,selectedEndPoint:o})}}},bindSumbitTap:function(t){var e=this.data.selectedStart,a=this.data.selectedEnd,s=this.data.selectedEndPoint;e&&a&&s&&this.triggerEvent("select",{start:e,end:a,endPoint:s})}}});