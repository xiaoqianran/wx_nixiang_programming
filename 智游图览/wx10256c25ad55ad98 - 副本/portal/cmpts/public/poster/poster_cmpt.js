var e,t=require("../../../../@babel/runtime/helpers/regeneratorRuntime"),i=require("../../../../@babel/runtime/helpers/asyncToGenerator"),n=(e=require("../../../cmpts/public/poster/wxa-plugin-canvas/poster/poster.js"))&&e.__esModule?e:{default:e};var r,o,s=require("../../../helper/page_helper.js"),a=require("../../../helper/pic_helper.js"),u=require("../../../helper/helper.js");Component({externalClasses:["poster-class"],options:{addGlobalClass:!0,multipleSlots:!0},properties:{config:{type:Object,value:null},isQr:{type:Boolean,value:!1},isFace:{type:Boolean,value:!1},doPoster:{type:Boolean,value:!0},show:{type:Boolean,value:!1},img:{type:String,value:""}},data:{isLoad:!1},lifetimes:{attached:function(){},ready:function(){this._init()},detached:function(){}},methods:{_init:(o=i(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),bindPosterTap:function(e){var n=this;this.setData({isCreate:!0,isLoad:!1},i(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.createPoster();case 2:case"end":return e.stop()}}),e)}))))},bindCloseTap:function(){this.setData({show:!1})},createPoster:(r=i(t().mark((function e(){var r,o,s=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={width:480,height:650,pixelRatio:2,backgroundColor:"#345678",debug:!1},o=this.data.config,u.isDefined(o.width)||(o.width=r.width),u.isDefined(o.height)||(o.height=r.height),u.isDefined(o.pixelRatio)||(o.pixelRatio=r.pixelRatio),u.isDefined(o.backgroundColor)||(o.backgroundColor=r.backgroundColor),u.isDefined(o.debug)||(o.debug=r.debug),this.setData({posterConfig:o},i(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.default.create(!0,s);case 2:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)}),onPosterFail:function(e){console.log(e)},bindPosterSuccessListener:function(e){var t=e.detail;this.setData({img:t,isLoad:!0})},url:function(e){s.url(e,this)},bindPosterFailListener:function(e){console.log(e)},bindSaveTap:function(e){var t=this;a.getWritePhotosAlbum((function(){wx.saveImageToPhotosAlbum({filePath:t.data.img,success:function(e){wx.showToast({title:"保存成功",icon:"success",duration:1e3})}})}))}}});