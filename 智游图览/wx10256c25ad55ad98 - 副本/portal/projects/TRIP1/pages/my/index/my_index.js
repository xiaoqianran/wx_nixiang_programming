var e,t,n,r,a=require("../../../../../../@babel/runtime/helpers/regeneratorRuntime"),i=require("../../../../../../@babel/runtime/helpers/asyncToGenerator"),s=require("../../../public/indexdata"),o=require("../../../../../helper/cache_helper.js"),c=require("../../../../../helper/page_helper.js"),u=require("../../../../../helper/cloud_helper.js"),p=require("../../../biz/project_biz.js"),l=require("../../../../../setting/setting.js"),h=require("../../../../../comm/biz/passport_biz.js"),f=getApp();Page({data:{rootScenicId:0},onLoad:(r=i(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.isLogin()&&((n={}).USER_NAME=h.getUserName(),this.setData({user:n})),p.initPage(this),null!=f.indexData){e.next=5;break}return e.next=5,(0,s.initIndexData)(this.data.rootScenicId,!0);case 5:this.setData({rootScenicId:f.indexData.sid});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)}),onReady:function(){},onShow:(n=i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.globalData.changeRootScenic.my_index&&(f.globalData.changeRootScenic.my_index=!1,this.setData({rootScenicId:f.globalData.changeRootScenic.sid})),h.clearToken(),h.loginSilence(this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),onHide:function(){},onUnload:function(){},_loadUser:(t=i(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={title:"bar"},e.next=3,u.callCloudData("user/detail",{},n);case 3:if(r=e.sent){e.next=7;break}return this.setData({user:null}),e.abrupt("return");case 7:this.setData({user:r});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)}),onPullDownRefresh:(e=i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadUser();case 2:wx.stopPullDownRefresh();case 3:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)}),onReachBottom:function(){},onShareAppMessage:function(){},url:function(e){c.url(e,this)},bindSetTap:function(e,t){var n;wx.showActionSheet({itemList:["清除缓存"],success:(n=i(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0==t.tapIndex&&(o.clear(),c.showNoneToast("清除缓存成功"));case 2:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)}),fail:function(e){}})},openCustomerServiceChat:function(){wx.openCustomerServiceChat({extInfo:{url:l.CUSTOMER_SERVICE_CHAT_URL},corpId:l.CUSTOMER_SERVICE_CHAT_CORPID,success:function(e){}})}});