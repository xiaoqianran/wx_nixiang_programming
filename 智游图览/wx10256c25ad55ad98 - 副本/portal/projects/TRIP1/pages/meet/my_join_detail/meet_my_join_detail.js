var e,t,r,n=require("../../../../../../@babel/runtime/helpers/regeneratorRuntime"),a=require("../../../../../../@babel/runtime/helpers/asyncToGenerator"),i=require("../../../../../helper/page_helper.js"),o=require("../../../../../helper/cloud_helper.js"),s=require("../../../../../helper/time_helper.js"),u=require("../../../../../lib/tools/qrcode_lib.js"),c=require("../../../biz/meet_biz.js"),l=require("../../../biz/project_biz.js");Page({data:{isLoad:!1,isShowHome:!1},onLoad:function(e){l.initPage(this),i.getOptions(this,e)&&(this._loadDetail(),e&&"home"==e.flag&&this.setData({isShowHome:!0}))},_loadDetail:(r=a(n().mark((function e(t){var r,a,i,s,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.data.id){e.next=3;break}return e.abrupt("return");case 3:return a={joinId:r},i={title:"bar"},e.prev=5,e.next=8,o.callCloudData("meet/my_join_detail",a,i);case 8:if(s=e.sent){e.next=12;break}return this.setData({isLoad:null}),e.abrupt("return");case 12:c=u.drawImg("meet="+s.JOIN_CODE,{typeNumber:1,errorCorrectLevel:"L",size:100}),this.setData({isLoad:!0,join:s,qrImageData:c}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),console.error(e.t0);case 19:case"end":return e.stop()}}),e,this,[[5,16]])}))),function(e){return r.apply(this,arguments)}),onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:(t=a(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDetail();case 2:wx.stopPullDownRefresh();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)}),onShareAppMessage:function(){},bindCancelTap:(e=a(n().mark((function e(t){var r,s=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=function(){var e=a(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={joinId:s.data.id},r={title:"取消中"},e.next=5,o.callCloudSumbit("meet/my_join_cancel",t,r).then((function(e){var t=s.data.join;t.JOIN_STATUS=10,s.setData({join:t}),i.showNoneToast("已取消")}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),i.showConfirm("确认取消该预约?",r);case 2:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),url:function(e){i.url(e,this)},bindNoticeTap:function(e){c.subscribeMessageMeet((function(){i.showSuccToast("开启成功")}))},bindCalendarTap:function(e){var t=this.data.join,r=t.JOIN_MEET_TITLE,n=s.time2Timestamp(t.JOIN_MEET_DAY+" "+t.JOIN_MEET_TIME_START+":00")/1e3,a=s.time2Timestamp(t.JOIN_MEET_DAY+" "+t.JOIN_MEET_TIME_END+":00")/1e3;i.addPhoneCalendar(r,n,a)}});