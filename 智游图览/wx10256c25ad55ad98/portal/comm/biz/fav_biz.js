var e=require("../../../@babel/runtime/helpers/regeneratorRuntime"),r=require("../../../@babel/runtime/helpers/asyncToGenerator"),t=require("../../../@babel/runtime/helpers/classCallCheck"),n=require("../../../@babel/runtime/helpers/createClass"),a=require("../../../@babel/runtime/helpers/possibleConstructorReturn"),u=require("../../../@babel/runtime/helpers/getPrototypeOf"),i=require("../../../@babel/runtime/helpers/inherits");function s(e,r,t){return r=u(r),a(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(r,t||[],u(e).constructor):r.apply(e,t))}var c=require("./base_biz.js"),l=require("../../helper/cloud_helper.js"),o=require("../../helper/page_helper.js"),p=require("../..//helper/cache_helper.js"),f=require("../../comm/constants.js"),h=getApp(),b=function(a){function u(){return t(this,u),s(this,u,arguments)}return i(u,c),n(u,null,[{key:"isFav",value:(v=r(e().mark((function r(t,n,a){var u,i;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=p.get(f.CACHE_TOKEN),n&&u&&u.id){e.next=3;break}return e.abrupt("return");case 3:t.setData({isFav:-1}),i={oid:n,favType:a},l.callCloudSumbit("fav/view",i,{title:"bar"}).then((function(e){t.setData({isFav:e.data.isFav})})).catch((function(e){}));case 6:case"end":return e.stop()}}),r)}))),function(e,r,t){return v.apply(this,arguments)})},{key:"updateFav",value:(b=r(e().mark((function r(t,n,a,u,i){var s,c,b,v,d;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=p.get(f.CACHE_TOKEN),n){e.next=3;break}return e.abrupt("return");case 3:if(s&&s.id&&h&&h.indexData&&h.indexData.fid){e.next=6;break}return wx.showModal({title:"温馨提示",content:"请先登录",showCancel:!1}),e.abrupt("return");case 6:if(c=o.getCurrentPageUrlWithArgs(),n&&c&&i&&(0==u||u)){e.next=9;break}return e.abrupt("return");case 9:return b={oid:n,title:i,favType:u,path:c},v={title:0==a?"收藏中":"取消中",method:"POST"},e.prev=11,e.next=14,l.callCloudSumbit("fav/view",b,v);case 14:d=e.sent,t.setData({isFav:d.data.isFav}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),console.log(e.t0);case 21:case"end":return e.stop()}}),r,null,[[11,18]])}))),function(e,r,t,n,a){return b.apply(this,arguments)})}]);var b,v}();module.exports=b;