var e,t,a,n=require("../../../../../../@babel/runtime/helpers/regeneratorRuntime"),i=require("../../../../../../@babel/runtime/helpers/asyncToGenerator"),r=require("../../../../../../index"),s=require("../../../public/indexdata"),c=require("../../../biz/project_biz.js"),o=require("../../../../../helper/page_helper.js"),u=require("../../../biz/scenic_biz.js"),d=getApp();Page({data:{mediaSrvUrl:(0,r.getServeUrl)(),sceniccover:null,rootScenicId:0},onLoad:(a=i(n().mark((function e(t){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.initPage(this),null!=d.indexData){e.next=4;break}return e.next=4,(0,s.initIndexData)(this.data.rootScenicId,!0);case 4:this.setData({sceniccover:d.indexData.index.sceniccover}),a=d.indexData.sid,this._getSearchMenu(),t&&t.id?this.setData({_params:{sortType:"cateId",sortVal:t.id,sid:a}}):this.setData({_params:{sortType:"cateId",sortVal:"",sid:a}});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)}),_reloadData:function(){var e=d.indexData.sid;this._getSearchMenu(),this.setData({_params:{sortType:"cateId",sortVal:"",sid:e}})},onReady:function(){},onShow:(t=i(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.globalData.changeRootScenic.scenic_index&&(this.data.rootScenicId=d.globalData.changeRootScenic.sid,d.globalData.changeRootScenic.scenic_index=!1,this._reloadData());case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)}),onHide:function(){},onUnload:function(){},url:(e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.url(t,this);case 1:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)}),bindCommListCmpt:function(e){o.commListListener(this,e)},onShareAppMessage:function(){},_getSearchMenu:function(){u.setCateTitle();var e=[{label:"全部",type:"cateId",value:""}],t=e=e.concat(u.getCateList());this.setData({sortItems:[[{label:"排序",type:"",value:""},{label:"最新",type:"sort",value:"update_time|desc"},{label:"最热",type:"sort",value:"viewcnt|desc"},{label:"推荐指数",type:"sort",value:"star|desc"}]],sortMenus:t})},bindMapTap:function(e){this.pageRouter.navigateTo({url:"/pages/index/index?rootScenicId="+e.currentTarget.dataset.oid})}});