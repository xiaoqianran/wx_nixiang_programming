var e=require("../../../../util/util");Page({onShareAppMessage:function(){return{title:"canvas",path:"packageComponent/pages/canvas/canvas-2d/canvas-2d"}},data:{theme:"light",canIUse:!0},onShow:function(){var e=this;setTimeout((function(){e._onReady()}),200)},_onReady:function(){var t=wx.getSystemInfoSync().SDKVersion;console.log(t),(0,e.compareVersion)(t,"2.7.0")<0?(console.log("123"),this.setData({canIUse:!1})):(this.position2D={x:150,y:150,vx:2,vy:2},this.x=-100,wx.createSelectorQuery().select("#canvas2D").fields({node:!0,size:!0}).exec(this.init.bind(this)))},init:function(e){var t=this,n=e[0].width,a=e[0].height,i=e[0].node;if(i){var o=i.getContext("2d"),s=wx.getSystemInfoSync().pixelRatio;i.width=n*s,i.height=a*s,o.scale(s,s);i.requestAnimationFrame((function e(){t.render(i,o),i.requestAnimationFrame(e)}));var r=i.createImage();r.onload=function(){t._img=r},r.src="./car.png"}else this.setData({canIUse:!1})},render:function(e,t){t.clearRect(0,0,305,305),this.drawBall2D(t),this.drawCar(t)},drawBall2D:function(e){var t=this.position2D;function n(t,n){e.beginPath(),e.arc(t,n,5,0,2*Math.PI),e.fillStyle="#1aad19",e.strokeStyle="rgba(1,1,1,0)",e.fill(),e.stroke()}t.x+=t.vx,t.y+=t.vy,t.x>=300&&(t.vx=-2),t.x<=7&&(t.vx=2),t.y>=300&&(t.vy=-2),t.y<=7&&(t.vy=2),n(t.x,150),n(150,t.y),n(300-t.x,150),n(150,300-t.y),n(t.x,t.y),n(300-t.x,300-t.y),n(t.x,300-t.y),n(300-t.x,t.y)},drawCar:function(e){this._img&&(this.x>350&&(this.x=-100),e.drawImage(this._img,this.x++,125,100,50),e.restore())},onUnload:function(){wx.offThemeChange&&wx.offThemeChange()},onLoad:function(){var e=this;this.setData({theme:wx.getSystemInfoSync().theme||"light"}),wx.onThemeChange&&wx.onThemeChange((function(t){var n=t.theme;e.setData({theme:n})}))}});