var e,t=require("../../../../../@babel/runtime/helpers/objectSpread2"),i=(e=require("../../utils/event-bus"))&&e.__esModule?e:{default:e},a=require("./route");function r(e,i){for(var a=[],r=0,n=e.length;r<n;r+=i){for(var o={index:Math.floor(r/i),list:[]},s=0;s<i;s++){var u=r+s,l=e[u];l&&o.list.push(t(t({},l),{},{index:u}))}a.push(o)}return a}Component({properties:{list:{type:Array,value:[]},imageWidth:{type:Number,value:0},imageMargin:{type:Number,value:0},lineLimit:{type:Number,value:3}},data:{showList:[],scrollIntoView:""},observers:{"list, lineLimit":function(e,t){e.length&&t&&this.setData({showList:r(e,t)})}},lifetimes:{created:function(){i.default.initWorkletEventBus(this.renderer),(0,a.initRoute)()},attached:function(){var e=this,t=this.getPageId(),a=null;this._onPreviewerChange=function(t){var i=e.data.list.findIndex((function(e){return e.id===t.id}));-1!==i&&(a&&clearTimeout(a),a=setTimeout((function(){var t=Math.floor(i/e.data.lineLimit);e.setData({scrollIntoView:"line-".concat(t)})}),500))},i.default.on("".concat(t,"PreviewerChange"),this._onPreviewerChange)},detached:function(){var e=this.getPageId();i.default.off("".concat(e,"PreviewerChange"),this._onPreviewerChange)}},methods:{onTapImage:function(e){var t=(e.currentTarget.dataset||{}).index,i=this.data.list[t];i&&wx.navigateTo({url:"../../pages/preview/index?imageid=".concat(i.id,"&sourcepageid=").concat(this.getPageId()),routeType:"fadeToggle"})}}});