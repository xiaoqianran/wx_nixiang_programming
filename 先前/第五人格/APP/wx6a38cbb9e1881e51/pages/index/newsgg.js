var a=getApp();Page({data:{imgUrl:a.globalData.imgUrl,apiUrl:a.globalData.apiUrl,wxToken:a.globalData.wxToken,newsList:[],pageNo:1,pageSize:10,videoHidden:!0,videoSrc:null,showSaishi:!1,listNull:!1,dailyIcon:wx.getStorageSync("daily-icon")},onShow:function(){this.setData({dailyIcon:wx.getStorageSync("daily-icon")||!1})},onLoad:function(){var e=this;wx.reportEvent("zx_notice",{}),a.globalData.pageIndex="/pages/index/index";var t=this;wx.request({url:this.data.apiUrl+"/w/epro/common/dict/get/type/data/remarks?type=game_video&name=display",data:{},success:function(a){var e=!1;"true"==a.data.msg&&(e=!0),t.setData({showSaishi:e})}}),this.setData({wxToken:a.globalData.wxToken}),this.data.wxToken?this.getData():a.initOkCallback=function(t){e.setData({wxToken:a.globalData.wxToken}),e.getData()}},topLink:function(a){wx.redirectTo({url:["/pages/index/index","/pages/index/newsgg","/pages/index/newszx","/pages/saishi/persent/persent","/pages/index/daily/index","/pages/index/fan/fan"][a.currentTarget.dataset.index]})},search:function(){wx.navigateTo({url:"../index/query?key="+this.data.queryKey}),wx.reportEvent("index_topsearch",{})},getData:function(){this.getNews()},getNews:function(){var a=this;wx.request({url:this.data.apiUrl+"/w/epro/article/catalog_page",data:{wxToken:a.data.wxToken,pageNo:a.data.pageNo,pageSize:a.data.pageSize,catalogId:"4767cb6f427a4c818b8892e6b6912113"},success:function(e){var t,i=[];e.data.data.items.forEach((function(a,e){var t=a.createTime.split(" ")[0].split("-");a.videoUrl&&a.videoUrl.indexOf("bilibili")>-1&&(a.isOut=!0),i[e]=a,i[e].showDate=t[1]+"-"+t[2]})),(t=a.data.newsList).push.apply(t,i),a.setData({newsList:a.data.newsList})},complete:function(){a.setData({listNull:!0})}})},myevent:function(a){this.setData({videoHidden:a.detail.videoHidden,videoSrc:a.detail.videoSrc})},callHideVideo:function(a){this.setData({videoHidden:a,videoSrc:null})},onReachBottom:function(){this.data.pageNo++,this.getNews()},handlerGobackClick:function(e){getCurrentPages();wx.redirectTo({url:a.globalData.pageIndex})},handlerGohomeClick:function(){wx.redirectTo({url:a.globalData.pageIndex})},handleCustomListChange:function(a){this.setData({newsList:a.detail})}});