var e=getApp();Page({data:{imgUrl:e.globalData.imgUrl,apiUrl:e.globalData.apiUrl,wxToken:e.globalData.wxToken,newsList:[],pageNo:1,pageSize:10,videoHidden:!0,videoSrc:null,showSaishi:!1,listNull:!1,dailyIcon:wx.getStorageSync("dailyIcon")},onShow:function(){this.setData({dailyIcon:wx.getStorageSync("daily-icon")||!1})},onLoad:function(){var a=this;wx.reportEvent("zx_information",{}),e.globalData.pageIndex="/pages/index/index";var t=this;wx.request({url:this.data.apiUrl+"/w/epro/common/dict/get/type/data/remarks?type=game_video&name=display",data:{},success:function(e){var a=!1;"true"==e.data.msg&&(a=!0),t.setData({showSaishi:a})}}),this.setData({wxToken:e.globalData.wxToken}),this.data.wxToken?this.getData():e.initOkCallback=function(t){a.setData({wxToken:e.globalData.wxToken}),a.getData()}},topLink:function(e){var a=["/pages/index/index","/pages/index/newsgg","/pages/index/newszx","/pages/saishi/persent/persent","/pages/index/daily/index","/pages/index/fan/fan"];console.log(e.currentTarget.dataset.index),console.log(a[e.currentTarget.dataset.index]),wx.redirectTo({url:a[e.currentTarget.dataset.index]})},getData:function(){this.getNews()},search:function(){wx.navigateTo({url:"../index/query?key="+this.data.queryKey}),wx.reportEvent("index_topsearch",{})},getNews:function(){var e=this,a=this;wx.request({url:this.data.apiUrl+"/w/epro/article/catalog_page",data:{wxToken:a.data.wxToken,pageNo:a.data.pageNo,pageSize:a.data.pageSize,catalogId:"5a82cb88f801470e9c3c7fe922a1adb0"},success:function(e){var t,i=[];e.data.data.items.forEach((function(e,a){var t=e.createTime.split(" ")[0].split("-");e.videoUrl&&e.videoUrl.indexOf("bilibili")>-1&&(e.isOut=!0),i[a]=e,i[a].showDate=t[1]+"-"+t[2]})),(t=a.data.newsList).push.apply(t,i),a.setData({newsList:a.data.newsList})},complete:function(){e.setData({listNull:!0})}})},myevent:function(e){console.log(e);console.log(e.detail.videoSrc),this.setData({videoHidden:e.detail.videoHidden,videoSrc:e.detail.videoSrc})},callHideVideo:function(e){this.setData({videoHidden:e,videoSrc:null})},handlerGobackClick:function(a){getCurrentPages();wx.redirectTo({url:e.globalData.pageIndex})},handlerGohomeClick:function(){wx.redirectTo({url:e.globalData.pageIndex})},onReachBottom:function(){this.data.pageNo++,this.getNews()}});