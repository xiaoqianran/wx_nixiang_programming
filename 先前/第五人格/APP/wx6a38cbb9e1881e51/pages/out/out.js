var t=getApp();Page({data:{originUrl:null,outUrl:null,shareH5Data:null},onLoad:function(a){var o=this;console.log("options",a),this.data.wxToken=t.globalData.wxToken,this.data.originUrl=a.url,this.data.wxToken?this.getData():t.initOkCallback=function(a){o.setData({wxToken:a}),o.getData(),t.initOkCallback=null},wx.reportEvent("news_details_out_pvuv",{news_name:a.url})},getData:function(){var a=this,o=decodeURIComponent(this.data.originUrl),n=o.split("?")[0],e=(o.split("?")[1]?o.split("?")[1]:"").split("&");console.log("originUrl",o),console.log(e),t.getAuthCode((function(o){o.data?(n=n+"?inMini=1&code="+o.data+"&wxToken="+a.data.wxToken,e.forEach((function(t,a){"code"!==t.split("=")[0]&&"inMini"!==t.split("=")[0]&&(n=n+"&"+t)})),console.log("_code",o.data),console.log("_url",n),a.setData({outUrl:n})):-10000301==o.code?a.data.onLogin||(a.data.onLogin=!0,t.getLogin(),t.initOkCallback=function(o){a.setData({wxToken:o}),a.getData(a.data.originUrl),t.initOkCallback=null,setTimeout((function(){a.data.onLogin=!1}),3e3)}):wx.showToast({icon:"none",title:o.msg})}))},handlerGobackClick:function(a){getCurrentPages().length>=2?wx.navigateBack({delta:a}):wx.redirectTo({url:t.globalData.pageIndex})},handlerGohomeClick:function(){wx.redirectTo({url:t.globalData.pageIndex})},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onMessage:function(t){this.setData({shareH5Data:t.detail.data[t.detail.data.length-1]})},onShareAppMessage:function(){return"https://cdn.evolong.top/pro/IdentityV_s01e01/index.html"==this.data.outUrl?{title:"描绘你的人格侧写",imageUrl:"https://nie.res.netease.com/id5/m/zt/20201215094138/data/p1/act_share1.jpg?as",path:"/pages/out/out?url="+this.data.outUrl}:this.data.outUrl.indexOf("dev.coc.10086.cn/coc/")>-1?{title:"第五人格×中国移动“铂金会员”活动",imageUrl:"https://dwxcx.fp.ps.netease.com/file/66755c7f4a89da0d6c078bd9B1itZCKh05",path:"/pages/out/out?url=".concat(this.data.originUrl)}:this.data.shareH5Data?(console.log("-----shareH5Data-----",this.data.shareH5Data),{title:this.data.shareH5Data.title,imageUrl:this.data.shareH5Data.imageUrl,path:this.data.shareH5Data.path}):void 0}});