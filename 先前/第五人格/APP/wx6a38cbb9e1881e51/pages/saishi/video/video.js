var a=require("../../../@babel/runtime/helpers/toConsumableArray"),t=getApp();Page({data:{imgUrl:t.globalData.imgUrl,apiUrl:t.globalData.apiUrl,wxToken:t.globalData.wxToken,popSelectShow:!1,tabBoxUrl:"",videoData:[],nowPage:1,canGetNextPage:!0,firstLoad:!0,tabBoxList:[],tbChPath:"",tbChIndex:0,tbChName:"",tbChName_end:""},onLoad:function(a){var e=this;this.setData({wxToken:t.globalData.wxToken,tabBoxUrl:a.comId}),this.data.wxToken?this.getData():t.initOkCallback=function(a){e.setData({wxToken:t.globalData.wxToken}),e.getData()}},getData:function(){this.getAllVideoAgain()},handlerGobackClick:function(a){getCurrentPages().length>=2?wx.navigateBack({delta:a}):wx.redirectTo({url:t.globalData.pageIndex})},handlerGohomeClick:function(){wx.redirectTo({url:t.globalData.pageIndex})},getAllVideoAgain:function(){var t=this;wx.request({url:this.data.apiUrl+"/w/spider/getspidervideodata",data:{wxToken:t.data.wxToken,tabBoxUrl:t.data.tabBoxUrl,index:t.data.nowPage},success:function(e){var o=e.data.data.videoList,n=t.data.videoData;if(t.data.firstLoad){var i=e.data.data.tabBoxList[0];e.data.data.selectList[0];t.setData({firstLoad:!1});var s=[];for(var r in i){var d={};d.name=r,d.path=i[r],s.push(d)}t.setData({tabBoxList:s,tbChName:s[0].name,tbChName_end:s[0].name})}n.push.apply(n,a(o)),t.setData({videoData:n,canGetNextPage:!0})}})},onReachBottom:function(){if(this.data.canGetNextPage){var a=this.data.nowPage+1;this.setData({nowPage:a,canGetNextPage:!1}),this.getAllVideoAgain()}},goOut:function(a){console.log(a,"外嵌页面");var t=a.currentTarget.dataset.src;t=t.replace("//www.","//m."),console.log(t,"newsVideosrc"),wx.navigateTo({url:"../../out/out?url="+t})},tableCh:function(a){this.setData({tbChIndex:a.currentTarget.dataset.index,tbChName:a.currentTarget.dataset.name,tbChPath:a.currentTarget.dataset.path})},selectByTimeOrZd:function(){""==this.data.zdChName?wx.showToast({title:"请选择您要搜索的视频类别",icon:"none",duration:1e3}):(this.setData({tabBoxUrl:this.data.tbChPath,tbChName_end:this.data.tbChName,nowPage:1,videoData:[]}),this.hidePop(),this.getAllVideoAgain())},onShareAppMessage:function(){},chSelect:function(a){this.setData({popSelectShow:!0})},hidePop:function(a){this.setData({popSelectShow:!1,selectIndex:-1})}});