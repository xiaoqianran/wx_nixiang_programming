var i=require("../../../@babel/runtime/helpers/defineProperty"),t=require("../../../utils/util"),a=t.encrypt,e=(t.decrypt,getApp());Component({properties:{unBindVisible:{type:Boolean,default:!0},visible:{type:Boolean,default:!0},thisPage:{type:String,default:""},cantClose:{type:Boolean,default:!1}},observers:{visible:function(i,t){var n,s,o;i||(wx.reportEvent("binding_pop_up_click",{}),null!==(n=e.globalData.userInfo)&&void 0!==n&&n.idvId?(this.setData({showFirstbindTips:!1}),"pages/vsrecord/index"==this.properties.thisPgae&&wx.reportEvent("record_changebind_click",{}),"pages/home/home/home"==this.properties.thisPgae&&wx.reportEvent("home_changebind_click",{})):(this.setData({showFirstbindTips:!0}),"pages/vsrecord/index"==this.properties.thisPgae&&wx.reportEvent("record_binding_click",{})),this.setData({copyCode:a('{"openId":"'.concat(null===(s=e.globalData)||void 0===s||null===(o=s.userInfo)||void 0===o?void 0:o.openId,'","appName":"D5_COMMUNITY_2", "time": ').concat(Date.now(),"}"))}))},thisPage:function(i,t){this.data.thisPgae=i},unBindVisible:function(i,t){this.setData({unBindVisibleHtml:i})}},data:i(i(i(i(i(i({unBindTipImgList:["https://nie.res.netease.com/id5/m/zt/20201215094138/data/active/pic1.jpg","https://nie.res.netease.com/id5/m/zt/20201215094138/data/active/pic3.jpg"],unBindVisibleDialog:!0,bindVisibleDialog:!1,bindFailVisibleDialog:!0,count:0,bingBtnloading:!1,firstBindPopShow:!1,showFirstbindTips:!1},"showFirstbindTips",!1),"showBindTips",!1),"copyCode",""),"currentNavIndex",0),"unBindVisibleHtml",!0),"bindLink",""),methods:{handleClick:function(){},handleCopyEncrypt:function(){var i,t,a=this;this.data.bingBtnloading||(this.setData({bingBtnloading:!0},(function(){setTimeout((function(){a.setData({bingBtnloading:!1})}),1e3)})),wx.reportEvent("copy_password_bind",{}),"pages/vsrecord/index"==this.data.thisPgae&&null!==(i=e.globalData.userInfo)&&void 0!==i&&i.idvId?wx.reportEvent("copy_password_bind_vsrecord",{}):"pages/home/home/home"==this.data.thisPgae&&null!==(t=e.globalData.userInfo)&&void 0!==t&&t.idvId&&wx.reportEvent("copy_password_bind_home",{}),wx.setStorageSync("openId_appName",!0),this.setData({showCopyUrl:!0}))},buildBindLink:function(){this.setData({bindLink:a('{"openId":"'.concat(e.globalData.userInfo.openId,'","appName":"D5_COMMUNITY_2", "time": ').concat(Date.now(),"}"))})},handleBindUserClose:function(){this.data.cantClose||(this.data.bindVisibleDialog?this.handUnBindProcess():this.triggerEvent("CustomClose",!0))},handleUnBindClose:function(){this.setData({unBindVisible:!0})},handleBindfail:function(){this.setData({bindVisibleDialog:!this.data.bindVisibleDialog,bindFailVisibleDialog:!this.data.bindFailVisibleDialog})},switchNav:function(i){var t=i.currentTarget.dataset.index;this.setData({currentNavIndex:t})},handUnBindProcess:function(){var i=this.data,t=i.unBindVisibleDialog,a=i.bindVisibleDialog;t&&wx.reportEvent("unbinding_tutorial_click",{}),this.setData({unBindVisibleDialog:!t,bindVisibleDialog:!a})},bindTipsShow:function(){this.setData({showBindTips:!this.data.showBindTips})},friLongpress:function(){console.log("friLongpress")},handlePreview:function(i){var t=i.target.dataset.index,a=this.data.unBindTipImgList;wx.previewImage({current:a[t],urls:this.data.unBindTipImgList})},handleSetInterval:function(){var i=this;"success"===e.globalData.closeDialog?(this.triggerEvent("CustomClose","true"),e.globalData.useBindCol&&(e.globalData.useBindCol=!1,e.clearGlobalData(),this.triggerEvent("bindCol",{gameId:e.globalData.userInfo.idvId},{}),wx.request({url:e.globalData.apiUrl+"/w/epro/wechatuser/mine/firstBind",data:{wxToken:e.globalData.wxToken},success:function(t){console.log("firstBind",t),t.data.data&&i.setData({firstBindPopShow:!0})}})),this.setData({unBindVisibleDialog:!0,bindVisibleDialog:!1,showCopyUrl:!1,status:!1}),e.globalData.closeDialog=!1):"reject"===e.globalData.closeDialog?(this.data.visible&&this.triggerEvent("CustomClose",!1),wx.removeStorageSync("openId_appName"),wx.showToast({icon:"error",title:"绑定失败"}),this.setData({status:!1}),e.globalData.closeDialog=!1):"unbind"===e.globalData.closeDialog&&(e.clearGlobalData(),this.triggerEvent("CustomReject",!1),e.globalData.closeDialog=!1,this.setData({status:!1})),this.buildBindLink()},closeFirstBindPop:function(){this.setData({firstBindPopShow:!1})},hidePop:function(t){this.setData(i({},t.currentTarget.dataset.name,!1))},showPop:function(t){this.setData(i({},t.currentTarget.dataset.name,!0))}},pageLifetimes:{show:function(){var i=this;console.log(this.data.unBindVisible);var t=0,a=setInterval((function(){e.globalData.userInfoCountStatus&&(i.handleSetInterval(),e.globalData.userInfoCountStatus=!1,clearInterval(a)),t>=5&&!1===e.globalData.closeDialog&&clearInterval(a),t++}),500)}}});