var t=require("../../../../@babel/runtime/helpers/toConsumableArray"),a=getApp();Page({data:{imgUrl:a.globalData.imgUrl,apiUrl:a.globalData.apiUrl,wxToken:a.globalData.wxToken,historyList:[],historyListNo:1,historyListReget:!0,searchOrder:""},onLoad:function(){var t=this;this.setData({wxToken:a.globalData.wxToken}),this.data.wxToken?this.getList():a.initOkCallback=function(e){t.setData({wxToken:a.globalData.wxToken}),t.getList()}},getList:function(){var a=this;if(!a.data.historyListReget)return!1;wx.request({url:this.data.apiUrl+"/w/epro/h55/exchange/record/page",data:{wxToken:a.data.wxToken,pageNo:a.data.historyListNo,pageSize:20,keyword:a.data.searchOrder},method:"GET",header:{wxToken:a.data.wxToken},success:function(e){var i=e.data.data.records;if(i.length<1)return a.data.historyListReget=!1,!1;a.setData({historyList:[].concat(t(a.data.historyList),t(i))})}})},handlerGobackClick:function(t){getCurrentPages().length>=2?wx.navigateBack({delta:t}):wx.redirectTo({url:a.globalData.pageIndex})},handlerGohomeClick:function(){wx.redirectTo({url:a.globalData.pageIndex})},onPullDownRefresh:function(){},onReachBottom:function(){this.getList()},confirmSearch:function(t){this.setData({historyList:[],historyListNo:1,historyListReget:!0,searchOrder:t.detail.value}),this.getList()},goDetail:function(t){var a=t.currentTarget.dataset.id;wx.navigateTo({url:"/pages_user/pages/saishi/dh/detail?id="+a})}});