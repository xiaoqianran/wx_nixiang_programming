var r=require("~/r");r("2TFr",Object.assign({},require("../c.js").modules,require("~/v.js").modules,require("~/c.js").modules,{"+Y/m":function(t,e){},"/Ej3":function(t,e){},"/WMc":function(t,e){},"/n46":function(t,e){},"042e":function(t,e){},"0D0K":function(t,e){},"0Iet":function(t,e){},"0XAq":function(t,e){},"1Bjr":function(t,e){},"1JO1":function(t,e){},"1gXJ":function(t,e){},"2TFr":function(t,e,n){n.r(e);n("SKHs"),n("m2V3")},"2kb3":function(t,e){},"2m3T":function(t,e){},"2pjk":function(t,e){},"3lAQ":function(t,e){},"4KEG":function(t,e){},"4WSx":function(t,e){},"4lf9":function(t,e){},"4oC7":function(t,e){},"53GB":function(t,e){},"55Cc":function(t,e){},"6U3b":function(t,e){},"6iAT":function(t,e){},"7Cf/":function(t,e){},"8+/t":function(t,e){},"8Cq2":function(t,e){},"8Ere":function(t,e){},"8S+i":function(t,e){},"8aq0":function(t,e){},"9Cpw":function(t,e){},"9ME7":function(t,e){},"9U4V":function(t,e){},ABDU:function(t,e){},AYC7:function(t,e){},B5JS:function(t,e){},BUIE:function(t,e){},BfBv:function(t,e){},CCwj:function(t,e){},COAg:function(t,e){},D2e6:function(t,e){},D84Y:function(t,e){},DBeL:function(t,e){},DR7t:function(t,e){},DvSL:function(t,e){},EInQ:function(t,e){},EKVP:function(t,e){},EW05:function(t,e){},EYwr:function(t,e){},F0jR:function(t,e){},FbGJ:function(t,e){},Ffv9:function(t,e){},FsgN:function(t,e){},GNYL:function(t,e,n){function a(t){Object.defineProperty(t,"store",{get:()=>t.ctx.cacheStore||null})}function o(t,e){e.cacheStore=t}n.d(e,"b",function(){return a}),n.d(e,"a",function(){return o})},GZxp:function(t,e){},GnFm:function(t,e){},HwgD:function(t,e){},I6uD:function(t,e){},"IPo+":function(t,e){},IhUE:function(t,e){},IiIR:function(t,e){},Iu3k:function(t,e){},J0aM:function(t,e){},"K0L/":function(t,e){},KkRJ:function(t,e){},Kkvk:function(t,e){},L63X:function(t,e){},LPyS:function(t,e){},LY43:function(t,e){},Lfdo:function(t,e){},LniI:function(t,e){},LsN0:function(t,e){},MKRp:function(t,e){},ML4D:function(t,e){},Nc4x:function(t,e){},"O/Fb":function(t,e){},OH4y:function(t,e,n){n.d(e,"a",function(){return f});var a=n("mzXD"),o=n.n(a),i=n("lv7w"),s=n.n(i),c=n("hnaY"),r=n.n(c),u=n("m6yS"),d=n.n(u);class f{constructor(t){this.ctx=t.ctx}}f.widgets={Main:o.a,TimePicker:s(),ContactList:r(),DeliveryScopePopup:d()}},OU5B:function(t,e){},OhE7:function(t,e){},OxQY:function(t,e){},PGcQ:function(t,e){},PIsN:function(t,e){},QMvF:function(t,e){},Qcor:function(t,e){},QgBQ:function(t,e){},Qj2J:function(t,e){},QoyA:function(t,e){},Qqcz:function(t,e){},Qt3Y:function(t,e){},RL9e:function(t,e){},RNop:function(t,e){},RmQ0:function(t,e){},"U3++":function(t,e){},USra:function(t,e){},Uv3o:function(t,e){},UzbL:function(t,e){},VAno:function(t,e){},VT8o:function(t,e){},VZqu:function(t,e){},W39q:function(t,e){},W4eX:function(t,e){},WJHR:function(t,e){},XALw:function(t,e){},XKO5:function(t,e,n){function a(t){return /^\d+$/.test(""+t)}function o(t){var e,{share_from:n,card_type:o,img_ps:i}=t||{},[s,c]=(e=decodeURIComponent(i||""))&&"string"==typeof e?e.split("|").map(t=>t.split(",").filter(t=>a(t)).map(t=>+t)):[];return{share_from:n,card_type:a(o)?+o:void 0,img_process_types:s,img_process_sub_types:c}}n.d(e,"b",function(){return a}),n.d(e,"a",function(){return o})},XM9b:function(t,e){},XWk2:function(t,e){},"YW/I":function(t,e,n){n.d(e,"a",function(){return b});var a=n("Fcif"),o=n("w2Y9"),i=n.n(o),s=n("mQXz"),c=n.n(s),r=n("KDJo"),u=n("2m3T"),d=n.n(u),f=n("4KEG"),h=n.n(f),l=n("U3++"),g=n.n(l),p=n("XKO5"),m=n("wGFT");class b{constructor(t){this.ctx=t.ctx}onShareAppMessage(){var{shareData:t,shopMetaInfo:e}=this.ctx.data,{id:n}=this.ctx.data.goods||{},o=t.path,s=o;if(t.isBooking)return t;if(o.startsWith("/pages/common/blank-page"))s=i.a.get("weappSharePath",o);else if(o.startsWith("undefined")){var{getQuery:u,route:d}=this.ctx.env,f=o.replace("undefined",d),h=u();this.ctx.data.shareData.path=i.a.add(f,c()(h,["access_token","app_id","prefetchKey"]))}else this.ctx.data.shareData.path=o;this.ctx.logger.log({et:"click",ei:"goods_share_result",en:"分享结果回调",si:"",params:{pagePath:s,sharePath:this.ctx.data.shareData.path}});var l=i.a.getAll(s);return this.ctx.logger.log({et:"view",ei:"goods_share_trigger_view",en:"商品详情分享触发",pt:"g",pi:n,params:Object(a.a)({},Object(p.a)(l),{goods_id:n})}),Object(r.c)(e)&&Object(m.a)(n),this.ctx.data.shareData}onShareTimeline(){var{shareData:t}=this.ctx.data,e=t.path.slice(t.path.indexOf("?")+1);return Object(a.a)({},t,{query:e})}}b.widgets={SharePop:h(),ActionItem:g(),Widget:d()}},YtP4:function(t,e){},Z63Q:function(t,e){},aFmi:function(t,e){},aKe6:function(t,e){},aN2w:function(t,e){},b1kB:function(t,e){},brGj:function(t,e){},byaO:function(t,e){},cGRu:function(t,e){},"cTa+":function(t,e){},ceIk:function(t,e){},cgff:function(t,e){},ciSm:function(t,e){},cxMM:function(t,e){},dLoJ:function(t,e){},dOZT:function(t,e){},dhKv:function(t,e){},ejNy:function(t,e){},fSch:function(t,e){},fiIn:function(t,e){},flvQ:function(t,e){},flx1:function(t,e){},foqm:function(t,e){},gKWa:function(t,e){},gf3M:function(t,e){},gq53:function(t,e){},h9FP:function(t,e){},hRw3:function(t,e){},hnaY:function(t,e){},i09R:function(t,e){},iNgw:function(t,e){},iO9C:function(t,e){},"iT+G":function(t,e){},jCRx:function(t,e){},jWfv:function(t,e){},jYdQ:function(t,e){},k7mJ:function(t,e){},kFjz:function(t,e){},kMQg:function(t,e){},kh7f:function(t,e){},lcWO:function(t,e){},lrt9:function(t,e){},lv7w:function(t,e){},lxKq:function(t,e){},m6yS:function(t,e){},mj9D:function(t,e){},mzXD:function(t,e){},n0bX:function(t,e){},nOsF:function(t,e,n){function a(t){return /^\d{15}$/gi.test(t)||/^\d{17}(\d|X)$/gi.test(t)&&function(t){for(var e=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=0,a=0,o=t.length;a<o-1;a++)n+=parseInt(t.charAt(a),10)*e[a];return["1","0","X","9","8","7","6","5","4","3","2"][n%11]===t.charAt(17).toUpperCase()}(t)}function o(t){var{order:e,idcard:n,tradeTag:o}=t;if(o.hasOverseaGoods){if(!n.name)return{name:"请输入真实姓名"};if(!n.number||!a(n.number))return{number:"请输入真实身份证号"};if(/^(71|81|82)/.test(n.number))return{number:"请输入中国大陆身份证号"};if(e.needIdCardPhoto&&(!n.frontPhoto||!n.backPhoto))return{message:"请上传身份证照"}}return""}n.d(e,"a",function(){return o})},"nSh/":function(t,e){},nqUG:function(t,e){},o2c2:function(t,e){},ouzC:function(t,e){},p1RP:function(t,e){},pDLA:function(t,e){},"pK7+":function(t,e){},pLyA:function(t,e){},pmvB:function(t,e){},rrZC:function(t,e){},s3lA:function(t,e){},sBTC:function(t,e){},sEE4:function(t,e){},sglO:function(t,e){},slkn:function(t,e){},tb2H:function(t,e){},u2AH:function(t,e){},uHSM:function(t,e){},uRYq:function(t,e){},uZOS:function(t,e){},ubH4:function(t,e){},ucHI:function(t,e){},"ucz/":function(t,e){},vJKw:function(t,e){},vMjE:function(t,e){},"vQ/Y":function(t,e){},vXaX:function(t,e){},vmqh:function(t,e){},wSzf:function(t,e){},wyd1:function(t,e){},xATW:function(t,e){},xaGs:function(t,e){},xgC2:function(t,e,n){n.d(e,"a",function(){return q});var a=n("Fcif"),o=n("+I+c"),i=n("VmCB"),s=n("dsC0"),c=n("X3j9"),r=n("gKCo"),u=n("KhBQ"),d=n("GUWE"),f=n("NHEX"),h=n.n(f),l=n("9ZMt"),g=n("US/N"),p=n("lgMb"),m=n("YeA1"),b=n("882d"),O=n("TO+A"),v=n("BwoW"),D=n("BrFj"),S=n("DLzb"),j=n("noo5"),I=n("Zf9w"),C=n("Shdd"),x=n("VmHG"),_=t=>({setUnInit(t){this.unInit=t},initStaticPage(){this.setPointsConfig()},setUserInfo(){t.lambdas.getUserInfo&&t.lambdas.getUserInfo().then(t=>{this.setCtxData({userInfo:t,buyerId:t.buyerId})})},setCtxData(e,n){var a=this.unInit?this.ctxDataObj:t.data;n?a[n]=e:Object.assign(a,e)},getCtxData(e){var n=this.unInit?this.ctxDataObj:t.data;return e?n[e]:n}}),k=n("RSyW"),y=n("31OO"),P=[k.a,y.a].reduce((t,e)=>Object(C.c)(t,e),{}),G={unInit:!1,ctxDataObj:{}};var w=n("Q4pQ"),L=n("1nOt"),T=n("qTUJ"),A=n("zjWU"),M=n("3KXO"),B=["unHandleError"],R=null,U=getApp(),{prefetchCache:E={}}=U||{},Q=Object.values(E),F=Object.keys(E)||"",K=Q.length;if(K&&1===K&&F.includes("GoodsDetail")){var N=Q[0];try{N.value.then(t=>{t&&t.goodsData&&(R=t)})}catch(t){}}class q{constructor(t){var e;this.ctx=t.ctx,this.store=(e=this.ctx,Object(x.a)({state:()=>Object(a.a)({},G,P.state),getters:Object(a.a)({},P.getters),actions:Object(a.a)({},_(e),P.getActions(e))})),this.store.setUnInit(t.unInit),this.init(t.unInit),this.initCloudData()}onPageHide(){setTimeout(()=>{A.a.end({isPageHide:!0})})}beforePageCreate(){var{ctx:t}=this;t.logger.setPageAsyncLog(),this.getQuery().then(e=>{var{wecom_chat_id:n}=e;n&&t.logger.setContext({wecom_chat_id:n});var{slg:a=""}=e;Object(S.a)(t,a)})}pageDestroyed(){this.clearGlobal()}setCtxData(t,e){return this.store.setCtxData(t,e)}getCtxData(t){return this.store.getCtxData(t)}initOid(){Object(m.b)(this,{oid:(t=>{var e=t;return t=>{var n=+t;n&&n!==e&&this.load({oid:n}),e=n}})(this.getOfflineId())})}init(t){if(void 0===t&&(t=!1),this._state={query:{},oid:0,staticData:{},asyncGoodsData:{},goodsSkuData:{goods:null},goodsData:{},userGoodsStateParams:{},isPageScrolled:!1},Object(u.c)()||(this.ctx.data.pageKey="goods_detail"),l.default.setGlobal("GOODS_BIZ_COMPONENTS",null),Object(b.a)(),this.initOid(),Object(x.c)(this,["shopConfig","alias","kdtId","query","goodsBaseInfo"]),Object(m.e)(this,{getGoodsDetail:t=>{var{unHandleError:e}=t,n=Object(o.a)(t,B);return this.getGoodsDetail(n,e).then(()=>this.getCtxData())}}),!t){Object(u.c)()||A.a.start({name:A.b.goods_detail,timeout:10});try{R&&(this.setInitGoodsData(R),R=null)}catch(t){var e=t||{},n=e.message||e.msg||"商品数据处理异常";A.a.end({name:A.b.goods_detail,level:"error",extra:{message:n}})}Object(m.d)(this,{"page-container:scrollLocked":t=>{this._state.isPageScrolled=!!t}}),Object(m.e)(this,{setShareIcon:t=>this.store.setUmpShareIcon(t),updateCartCount:()=>this.updateCartCount()}),this.load().then(t=>{this.__isPrefetched&&!this.__isPrefetchReloaded&&(this.__isPrefetchReloaded=!0,this.load()),this.ctx.event.emit("goodsSetupInit",t)}).catch(t=>{var e="";if("string"==typeof t)e=t;else{var{message:n,msg:a,data:o={}}=t||{};e=n||a||o.msg||"获取商品数据接口失败"}A.a.end({name:A.b.goods_detail,level:"error",extra:{message:e}})})}}setInitGoodsData(t){this._state.staticData=t;var e=Object(i.a)(this._state,t.shopConfig);this._state.goodsSkuData=e;var n=Object(r.a)(t,e),{title:o,pictures:s=[]}=n.goodsBaseInfo;return this.setCtxData(Object(a.a)({},n,{navigationText:o,cpsConfigKey:"cps_goods_recommend_goods_detail"})),Object(L.a)(n.shopConfig),0!==s.length&&s||A.a.end({name:A.b.goods_detail,type:"finish",extra:{message:"商品主图为空"}}),this.setGlobal(n),t}getQuery(){return this.__getQueryPromise||(this.__getQueryPromise=this.ctx.env.getQueryAsync().then(t=>(t=Object(T.a)(t),this._state.query=t,this.setCtxData(t,"query"),t))),Promise.resolve(this.__getQueryPromise)}setGlobal(t,e){void 0===e&&(e="GOODS_DATA"),l.default.setGlobal(e,Object(a.a)({},l.default.getGlobal(e),t))}clearGlobal(t){void 0===t&&(t="GOODS_DATA"),l.default.setGlobal(t,null)}load(t){this.store.setUserInfo();var{oid:e=this.getOfflineId()}=t||{};return this.getQuery().then(t=>Object(a.a)({},t,{oid:e})).then(t=>this.getGoodsDetail(t).then(t=>(this.updateCartCount(),this.prefetchDetailComponents(this.getCtxData()),t))).catch(t=>{throw"string"==typeof t&&wx.showToast({title:t,icon:"none"}),t})}getGoodsDetail(t,e){void 0===e&&(e=!1);var{ctx:n}=this,o=Object(a.a)({},t);"helpcut"===o.type&&(o.activityType="helpCut");var{alias:i}=t;if(!i||"undefined"===i||"null"===i)return Promise.reject("商品不存在");var{scene:s}=l.default.getAppOptions();return 1154===s&&this.setCtxData(i,"alias"),o.scene=s,Object(u.b)(n,i),o.hasDesign=Object(M.a)(this.ctx.cloud.hasDesgin),Promise.all([Object(d.a)(n,t),Object(u.a)(n,o)]).then(t=>{var[e,n]=t;this.__isPrefetched=n.__isPrefetched,this.clearGlobal();var a=n;return a=this.formatWeappStaticParams(a,e)}).then(t=>{t=this.setInitGoodsData(t),n.inited(),this.store.initStaticPage();var{shopMetaInfo:{isChainStore:e},pageFeature:a,marketing:o}=t;return e?Object(d.c)(n,t):t}).then(t=>{try{return this.processUserGoodsStateData(t)}catch(t){throw t.message="[商详页初始化-processUserGoodsStateData] "+t.message,t.isClientError=!0,n.hummer&&n.hummer.capture(t),t}}).then(e=>(this.setGlobal(e),this.updateLocationAsync(e),n.event.emit("goodsSetupReady"),U.trigger("goods-detail:page-skeleton:visible",!1),n.hummer&&n.hummer.markRendered("goods-page-setup:ready"),Object(w.a)(t),e)).catch(n=>e?Promise.reject(n):Object(v.a)(n,t,()=>{this.getGoodsDetail(t)})).then(t=>(this.parseWeappDataAfter(t),this.getStockRemindStatus(t),this.getRetailInfo(t),this.handleUpdateSkuOrderState(t,o),this.setGlobal(t),t)).catch(n=>e?Promise.reject(n):(n.data=n.data||{},n.data.showError=!1,Object(v.a)(n,t,()=>{this.getGoodsDetail(t)})))}handleUpdateSkuOrderState(t,e){this.updateSkuDirectOrderState({supportSkuDirectOrder:h()(t,"goodsData.isSupportSkuDirectOrder"),skuDirectVersion:h()(t,"goodsData.skuDirectVersion"),alias:h()(t,"goodsData.goods.alias")})}processUserGoodsStateData(t){void 0===t&&(t={}),this._state.userGoodsStateParams=t.userGoodsStateParams,this._state.asyncGoodsData=t,this._state.serverStatus=this.getServerStatus(t);var e=Object(r.b)(this._state),{buyConfig:n,goodsActivity:o,goodsSkuData:i,goodsPriceInfo:c,serverStatus:d,pageFeature:f}=e,h=Object(a.a)({},this.getCtxData("goodsMetaInfo"),e.goodsMetaInfo),{supportItemProps:l,showStockLackReminder:g}=h;g&&i&&i.goods&&(i.goods.disableSoldoutSku=!1);var p=Object(a.a)({},t,e),{userGoodsStateParams:m,ump:b,marketing:O}=t,v={marketing:O,activity:o,sku:i,priceInfo:c,buyConfig:n,serverStatus:d,pageFeature:f,supportItemProps:l,buyLimitGuideInfo:t.buyLimitGuideInfo,userGoodsStateParams:m,ump:b},D=this.store.parseMemeberActivies(v),S=this.store.parseUmpActivies(D);h.showStockLackReminder&&S.sku&&S.sku.goods&&(S.sku.goods.disableSoldoutSku=!1);var j=(t.itemExtendInfo||{}).SKU_DECISION,I=Object(a.a)({},e,{goodsSkuData:S.sku,goodsPriceInfo:S.priceInfo,goodsMetaInfo:Object(a.a)({},h,this.getCtxData("goodsMetaInfo"),{supportItemProps:S.supportItemProps}),multiSkuDecision:!j||j.ignoreItem?{}:j,goodsCombineInfo:Object(s.f)(t.goodsData),wholesalerModel:p.wholesalerModel,voucherModelList:(t.goodsData||{}).voucherModelList||[],userGoodsStateParams:m,pageParams:p.pageParams});return this.setGlobal(Object(a.a)({},D,S)),this.setCtxData(I),this.ctx.data.hasFinishLoad=!this.__isPrefetched||this.__isPrefetchReloaded,Object(u.c)()||setTimeout(()=>Object(u.d)(this.getCtxData()),5e3),Promise.resolve(p)}updateCartCount(){var{shopConfig:t={},pageSwitch:e={}}=this.getCtxData();return+t.hideShoppingCart||!e["cart-count"]?Promise.reject():(this.__updateCartCount||(this.__updateCartCount=this.ctx.process.invokePipe("beforeRefreshCartCount").then(t=>void 0!==t?t:Object(D.b)()).then(t=>(this.setGlobal({cartCount:t}),this.ctx.data.cartCount=t,this.__updateCartCount=null,t)).catch(t=>{throw this.__updateCartCount=null,t})),this.__updateCartCount)}updateLocationAsync(t){var{offlineData:e,pageFeature:n,goodsData:o,physicalStores:i}=t;if(e.id)e.needGetLocation=!0,Object(d.a)(this.ctx,e).then(t=>{var{lat:a,lng:i}=t,{lng:s,lat:r}=e.address||{},u={distance:Object(j.calculateDistance)(r,s,a,i),lng:i,lat:a};(n.showMultiStoreRecommend?Object(D.g)({currentStoreId:e.id,lng:i,lat:a,goodsId:o.goods.id,kdtId:+o.kdtId}):Promise.resolve([])).then(t=>{var n=this.getCtxData("multistore")||{};Object.assign(n,Object(c.a)(e,{geoLocationData:u,salableStores:t}),{asyncGetLocationFinished:!0}),this.setCtxData(n,"multistore")})});else if(i&&i.shopCount>0){e.needGetLocation=!0;Object(d.a)(this.ctx,e).then(t=>{var{lat:e,lng:n}=t;return new Promise(t=>{var o;Object(D.a)().then(i=>{o=i?i.isNewTemplate?i:JSON.parse(i.components)[0]||JSON.parse(i.components):{showType:0},t(Object(a.a)({lat:e,lng:n},o))}).catch(i=>{o={showType:1},t(Object(a.a)({lat:e,lng:n},o))})})}).then(t=>{var{lat:e,lng:n,showType:o}=t;Object(D.f)({showType:o,lon:n,lat:e,storeName:"",toBd:!0}).then(t=>{var{items:e}=t,n=e[0]||{},o=this.getCtxData("physicalStores");o.physicalStoreBasicInfoModels.length&&(Object.assign(o.physicalStoreBasicInfoModels[0],{physicalStoreName:n.storeName,physicalStoreAddress:n.storeAddress,distance:n.distance}),this.setCtxData({physicalStores:Object(a.a)({},o)}))})})}}updateSkuDirectOrderState(t){var{supportSkuDirectOrder:e,skuDirectVersion:n,alias:a}=t;this.setCtxData(e,"userStateSupportSkuDirectOrder"),this.setCtxData(n,"skuDirectVersion"),this.ctx.process.invokePipe("updateSupportSkuDirectOrder",{alias:a,isSkuDirectOrder:e}),e&&this.ctx.process.invokePipe("updateBtnsUI"),n>0&&!Object(u.c)()&&this.ctx.logger&&this.ctx.logger.log({et:"custom",ei:"goods_detail",en:"商品详情页浏览",params:{support_sku_direct_order:+e}})}getOfflineId(){var t=this.getCtxData("oid")||0,{query:e={}}=this._state;return+t||+e.oid||0}getServerStatus(t){var e=+new Date,{serverTimestamp:n=e}=t;return{fetchSuccess:!0,serverDeltaTime:n-e,clientTimestamp:e,serverTimestamp:n}}getStockRemindStatus(t){var{goods:{id:e},skuInfo:{skuStocks:n}}=t.goodsData,{showStockLackReminder:o}=this.getCtxData("goodsMetaInfo");if(o){var i={itemId:e,remindTypeEnum:"ITEM_STOCK_REMIND"},s=[];n&&n.length>0&&(s=n.filter(t=>0===t.stockNum).map(t=>t.skuId),i.skuIds=s.join(",")),Object(g.requestV2)({method:"POST",path:"/wscgoods/hasSaleReminderByBatch.json",data:i,withCredentials:!0}).then(t=>{var e={};n&&n.length>0?s.length>0&&t.forEach((t,n)=>{e[s[n]]=t}):e.hasRemindSpuStock=t,this.setCtxData(Object(a.a)({},this.getCtxData("goodsMetaInfo"),{stockRemindStatus:e}),"goodsMetaInfo"),this.ctx.process.invokePipe("updateBtnsUI")}).catch(t=>{Object(p.b)(t,{message:"获取补货提醒状态失败，请稍后重试"})})}}prefetchDetailComponents(t){var{goodsBaseInfo:e,shopBaseInfo:n,env:a}=t,{platform:o,isDangerous:i}=a;if(n.kdtId&&e.alias&&void 0!==o){var s={alias:e.alias,isFastBuy:h()(e,"fastbuyFeature.isFastBuy",void 0),platform:o,danger:Number(i),bizName:"itemDetail",queryKeys:"alias,platform",stage:100,teeEnv:l.default.getEnv()},c=Object(D.c)(s);l.default.setGlobal("GOODS_BIZ_COMPONENTS",c)}}onPullDownRefresh(){this._state.isPageScrolled||this.load().then(()=>{Object(O.b)()}).catch(()=>{Object(O.b)()})}getRetailInfo(t){var e=h()(t,"goodsData.goods.alias");7===h()(t,"goodsData.shop.shopType")&&Object(D.e)(e).then(t=>{if(t.length>0){var e=t[0];this.setCtxData({show:e.stock_num>0,address:e.address},"retail")}})}getPlatform(t){this.ctx.lambdas.getPlatform&&this.ctx.lambdas.getPlatform().then(e=>{t.platform=e})}formatWeappStaticParams(t,e){var{lng:n,lat:a}=e;this.getPlatform(t);var{lng:o,lat:i}=t.offlineAddress||{},s=Object(j.calculateDistance)(i,o,a,n);return t.geoLocationData={distance:s,lng:n,lat:a},t.userGoodsStateParams=Object(d.b)(t,{lng:n,lat:a}),t}parseWeappDataAfter(t){var e=h()(t,"goodsData.goods.id"),n=h()(t,"goodsData.goods.title"),o=h()(t,"goodsEnterPageParams",{});Object(u.c)()||this.ctx.logger.setPageInitConfig({pageType:"g",pageId:e,title:n,eventParams:Object(a.a)({},o,{goods_id:e})}),setTimeout(()=>this.logLive(t),2e3)}logLive(t){var{room_id:e,roomId:n}=this._state.query,{goodsData:a={},shopMetaInfo:o={}}=t,{alias:i}=a,{isChainStore:s,kdtId:c,rootKdtId:r}=o,u=e||n;if(u&&i)return Object(g.default)({path:"/wscshop/mplive/collect.json",withCredentials:!0,data:{alias:i,kdtId:s?r:c,roomId:u}})}initCloudData(){}}q.lambdas={checkFromChannelsOpenFlow:I.c,checkFromShowcase:I.d,checkIsChannels:I.e,checkIsHalfScreen:I.g,checkIsNeedSyncOrderScene:I.h,checkIsOpenByLiveBag:I.i,checkIsOpenByLiveGoodsShare:I.j,checkIsWxvideoLive:I.l}},xxQs:function(t,e){},"yd+z":function(t,e){},ygrD:function(t,e,n){n.d(e,"a",function(){return i});var a=n("K0L/"),o=n.n(a);class i{constructor(t){this.ctx=t.ctx,this.initCloudData()}initCloudData(){}}i.widgets={Main:o()}},ythx:function(t,e){},zdHw:function(t,e){},zfxi:function(t,e){}}));