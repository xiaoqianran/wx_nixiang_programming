Object.defineProperty(exports,"__esModule",{value:!0}),exports.GeoMetry=void 0;var t=require("../../@babel/runtime/helpers/classCallCheck"),e=require("../../@babel/runtime/helpers/createClass"),a=require("./coordinateTranslate"),n=function(){function n(){t(this,n),this.init()}return e(n,[{key:"init",value:function(){this.coordinateTranslate=new a.CoordinateTranslate}},{key:"getLength",value:function(t,e){var a=this.coordinateTranslate.latLng2Mercator(t[1],t[0]),n=this.coordinateTranslate.latLng2Mercator(e[1],e[0]);return Math.sqrt((a.x-n.x)*(a.x-n.x)+(a.y-n.y)*(a.y-n.y))}},{key:"latlngDistanceTo",value:function(t,e){var a={x:t.longitude,y:t.latitude},n={x:e.longitude,y:e.latitude};return this.distanceTo(a,n)}},{key:"distanceTo",value:function(t,e){var a,n=[0,0,0],i=[0,0,0],r=t.x,s=t.y,o=e.x,l=e.y;r*=.01745329251994329,s*=.01745329251994329,o*=.01745329251994329,l*=.01745329251994329;var h=Math.sin(r),u=Math.sin(s),c=Math.cos(r),M=Math.cos(s),g=Math.sin(o),y=Math.sin(l),d=Math.cos(o),v=Math.cos(l);return n[0]=M*c,n[1]=M*h,n[2]=u,i[0]=v*d,i[1]=v*g,i[2]=y,a=Math.sqrt((n[0]-i[0])*(n[0]-i[0])+(n[1]-i[1])*(n[1]-i[1])+(n[2]-i[2])*(n[2]-i[2])),12742001.5798544*Math.asin(a/2)}},{key:"headingTo",value:function(t,e){var a=e.x-t.x,n=e.y-t.y,i=180*Math.atan2(a,n)/Math.PI;return i>=360?i-=360:i<0&&(i+=360),i}},{key:"getNearsetPoint",value:function(t,e,a){var n,i,r,s,o,l,h,u=1e5*e[0],c=1e5*e[1],M=1e5*a[0],g=1e5*a[1],y=1e5*t[0],d=1e5*t[1],v=M-u,p=g-c,f=Math.sqrt(v*v+p*p),P=y-u,b=d-c,x=Math.sqrt(P*P+b*b),T=[],k={},j=0;if(f<1e-9)return x<1e-9?(T[0]=e[0],T[1]=e[1],j=0,k.minDist=j,k.projectType=0,k.stProjectPos=T,k):(T[0]=e[0],T[1]=e[1],j=x,k.minDist=j,k.projectType=-1,k.stProjectPos=T,k);if((r=(n=v/f)*P+(i=p/f)*b)<1e-9)return T[0]=e[0],T[1]=e[1],j=x,k.minDist=j,k.projectType=-1,k.stProjectPos=T,k;if(r-f>-1e-9){var m=y-M,q=d-g,C=Math.sqrt(m*m+q*q);return T[0]=a[0],T[1]=a[1],j=C,k.minDist=j,k.projectType=1,k.stProjectPos=T,k}return l=y-(s=u+r*n),h=d-(o=c+r*i),j=Math.sqrt(l*l+h*h),T[0]=s/1e5,T[1]=o/1e5,k.minDist=j,k.projectType=0,k.stProjectPos=T,k}},{key:"bearing",value:function(t,e){var a=Math.PI/180,n=t.latitude*a,i=e.latitude*a,r=t.longitude*a,s=e.longitude*a,o=Math.sin(s-r)*Math.cos(i),l=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(s-r),h=(180*Math.atan2(o,l)/Math.PI+360)%360;return h}},{key:"angle",value:function(t,e,a){return Math.abs(this.bearing(e,a)-this.bearing(t,e))}},{key:"calClockwiseAngle",value:function(t,e){var a=t&&"number"==typeof t.angle?t.angle:t&&t.latlng1&&t.latlng2&&this.bearing(t.latlng1,t.latlng2),n=(e&&"number"==typeof e.angle?e.angle:e&&e.latlng1&&e.latlng2&&this.bearing(e.latlng1,e.latlng2))-a;return n=n>0?n:n+360}},{key:"calCoordinate",value:function(t,e,a,n,i,r,s){this.latitude=t,this.longitude=e,this.speed=a||0,this.heading=n,this.accuracy=i,this.timestamp=r,this.altitude=s,this.pos=[],this.a={x:128,y:128},this.b=256/360,this.c=256/(2*Math.PI),this.d=!0}}]),n}();exports.GeoMetry=n;