var t=require("../../@babel/runtime/helpers/interopRequireDefault"),e=require("../../@babel/runtime/helpers/toConsumableArray"),a=require("../../utils/icon"),r=t(require("../../utils/systemInfo"));Component({properties:{sourceData:{type:Object,observer:function(t){var e=t.activeIndex||0,a=t.start,r=t.end,i=t.type;if("driving"===i){var s=t.cardData[e],d=s.segmentList,l=s.endWalkInfo,c=s.startWalkInfo;this.setData({type:i,meta:null,activeIndex:e,cards:t.cardData,data:o({segmentList:d,start:a,end:r,type:i,endWalkInfo:l,startWalkInfo:c})})}if("walk"===i&&t.cardData){var u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=[];for(var a in n)t[a]&&e.push({val:t[a],text:n[a]});return e}(t.cardData);t.end.floorName&&u.unshift({text:"目的地在",val:t.end.floorName}),this.setData({type:i,meta:{title:"".concat(t.cardData.time," ").concat(t.cardData.distance),des:u},cards:null,data:o({segmentList:t.segmentList,start:a,end:r,type:i})})}}}},data:{CDN_PATH:a.CDN_PATH,scrollTop:0,type:"walk",data:[],themeColor:""},lifetimes:{ready:function(){var t=r.default.globalData.themeColor;this.setData({themeColor:t})}},methods:{toggleChildren:function(t){var a=t.currentTarget.dataset.index;if(void 0!==a){var r=e(this.data.data),n=r[a];n.childrenVisible=!n.childrenVisible,this.setData({data:r})}},selectCardItem:function(t){t.currentTarget.dataset&&this.triggerEvent("selectDriving",{index:t.currentTarget.dataset.index||0}),this.setData({scrollTop:0})}}});var n={underpass_num:"地下通道",crosswalk_num:"人行横道",overpass_num:"天桥",light_num:"红绿灯",kcal:"燃烧"};function i(t){return t.buildingid&&t.__downup?a.STAIRS_CONFIG[t.cl_type+""+t.__downup]:t.maneuverType?a.DIRECTION_CONFIG[t.maneuverType]:a.CN_DIRECTION_CONFIG[t.action]}function o(t){var e=t.segmentList,r=void 0===e?[]:e,n=t.start,o=void 0===n?{}:n,d=t.end,l=void 0===d?{}:d,c=t.type;t.startWalkInfo,t.endWalkInfo;r.forEach((function(t,e){t.action||0===e||(t.action=r[e-1].action)}));var u=[{title:"".concat(o.name),extra:o.floorName||"",icon:{url:a.POSITION_ICON},distance:s(r[0]),roadName:r[0].roadName||"无名路"}];if("driving"===c)for(var m=1;m<r.length;m++){var f=r[m-1],v=r[m],h={url:i(f)};u.push({icon:h,hasSolidLine:!v.hasOwnProperty("buildingid"),title:f.action,extra:v.textInfo,distance:s(v),roadName:v.roadName||"无名路"})}else if("walk"===c){u[0].distance=u[0].distance.replace("行驶","行进")+"米";for(var p=1;p<r.length;p++){var g=r[p-1],I=r[p],N={url:i(g)};u.push({icon:N,hasSolidLine:!I.hasOwnProperty("buildingid"),title:g.action,extra:I.textInfo,roadLength:I.roadLength,roadName:I.roadName||"无名路"})}for(var D=1;D<u.length;D++){var C=u[D-1],_=u[D];C.title===_.title&&C.roadName===_.roadName&&(C.distance+=_.distance,u.splice(D,1),D--)}for(var y=1;y<u.length;y++)u[y].distance=s(u[y])}var O={title:l.name,extra:l.floorName||"",icon:{url:a.POSITION_ICON}};return u.push(O),u}function s(t){return t?t.distance?"行驶"+t.distance:t.roadLength?"行进"+t.roadLength+"米":"":""}