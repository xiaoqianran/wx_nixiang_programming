var e=require("../../@babel/runtime/helpers/slicedToArray"),t=require("../../common/vendor.js"),a=require("../../config/config.js"),n=require("../../config/tips.js"),o={data:function(){return{exam:[],term:getApp().globalData.term,showEmpty:!0,kevyType:"loading",kevyText:"加载中..."}},onLoad:function(){this.getExam()},computed:{},methods:{getExam:function(){var e=this;t.index.getStorage({key:"exams",success:function(a){a.data&&(e.exam=a.data.data),a.data.account!=getApp().globalData.account?e.getExamFromService():(new Date).getTime()-a.data.date>=108e5&&(t.index.showLoading({title:"更新中..."}),e.getExamFromService())},fail:function(t){e.getExamFromService()}})},getExamFromService:function(){var e=this;t.index.request({url:a.config.examsUrl,method:"GET",data:{account:getApp().globalData.account,term:getApp().globalData.term},header:{token:getApp().globalData.token},success:function(a){"0"==a.data.code?(e.exam=a.data.data,e.showEmpty=!1,t.index.setStorage({key:"exams",data:{account:getApp().globalData.account,date:(new Date).getTime(),data:e.exam},success:function(e){},fail:function(e){}})):"C0102"==a.data.code?(e.kevyType="data",e.kevyText="还没有考场安排噢",e.showEmpty=!0):(t.index.showToast({title:a.data.message,icon:"error"}),e.kevyType="error",e.kevyText=n.tips.error,e.showEmpty=!0)},fail:function(a){t.index.showToast({title:"请检查网络连接",icon:"error"}),e.kevyType="network",e.kevyText=n.tips.network,e.showEmpty=!0}})},isPast:function(t,a){var n=new Date(t),o=a.split("-"),r=e(o,2),i=(r[0],r[1]),s=new Date,c=i.split(":"),m=new Date(n);return m.setHours(parseInt(c[0],10)),m.setMinutes(parseInt(c[1],10)),m<s}}};Array||(t.resolveComponent("uni-card")+t.resolveComponent("kevy-empty"))(),Math||(function(){return"../../uni_modules/uni-card/components/uni-card/uni-card.js"}+function(){return"../../uni_modules/kevy-empty/components/kevy-empty/kevy-empty.js"})();var r=t._export_sfc(o,[["render",function(e,a,n,o,r,i){return t.e({a:t.p({"is-full":!0,"is-shadow":!1}),b:!e.showEmpty},e.showEmpty?{}:{c:t.f(e.exam,(function(a,n,o){return{a:t.t(e.isPast(a.day,a.time)?"已考":"未考"),b:t.n(e.isPast(a.day,a.time)?"past":"coming"),c:t.t(a.name),d:t.t(a.campus),e:t.t(a.examRoom),f:t.t(a.day),g:t.t(a.time),h:t.t(a.candidateId),i:null!=a.candidateId,j:n}}))},{d:t.p({type:e.kevyType,text:e.kevyText,show:e.showEmpty})})}]]);wx.createPage(r);