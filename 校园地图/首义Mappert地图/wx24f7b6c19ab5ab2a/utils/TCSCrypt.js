var TCSCrypt=new Object();TCSCrypt.keycode="ABCDEFGHIJKLMNOPQRSTUVWXYZaiotfqresv0123456789~!@#$%^&*zkg=wcd?:j";TCSCrypt.ekeycode="ABCDEFGHIJKL~MNOPQRSTUVWXYZ!abcdefghijklmnopqrstuvwxyz*0123456789";TCSCrypt.encryptCode=function(pwd){if(this.useekeycode){var keycode=this.ekeycode;}else{var keycode=this.keycode;}
keycode=keycode.split("");for(var i=0;i<keycode.length;i++){var idx=keycode.indexOf(pwd[i%pwd.length]);idx=(idx<0?0:idx);var pos=(idx+i)%keycode.length;var tmp=keycode[pos];keycode[pos]=keycode[i];keycode[i]=tmp;}
return keycode.join("");}TCSCrypt.useekeycode=false;TCSCrypt.dim=64;TCSCrypt.pwd="aft";TCSCrypt.encode=function(a){var d=this.encryptCode(this.pwd);var dim=this.dim;a=encodeURIComponent(a);for(var b,c,e,f,g,h,i,j="",k=0;k<a.length;){b=a.charCodeAt(k++);c=a.charCodeAt(k++);e=a.charCodeAt(k++);f=b>>2;g=(3&b)<<4|c>>4;h=(15&c)<<2|e>>6;i=(dim-1)&e;isNaN(c)?h=i=dim:isNaN(e)&&(i=dim);j=j+d.charAt(f)+d.charAt(g)+d.charAt(h)+d.charAt(i);}
return j},TCSCrypt.decode=function(a){var d=this.encryptCode(this.pwd);var dim=this.dim;var b,c,e,f,g,h,i,j="",k=0;for(;k<a.length;){f=d.indexOf(a.charAt(k++));g=d.indexOf(a.charAt(k++));h=d.indexOf(a.charAt(k++));i=d.indexOf(a.charAt(k++));b=f<<2|g>>4;c=(15&g)<<4|h>>2;e=(3&h)<<6|i;j+=String.fromCharCode(b);dim!=h&&(j+=String.fromCharCode(c));dim!=i&&(j+=String.fromCharCode(e));}
return decodeURIComponent(j);}TCSCrypt.decodeFunc=function(data,pwd,json_parse=true){this.pwd=pwd;var decrypt=this.decode(data);if(json_parse){return JSON.parse(decrypt);}else{return decrypt;}}TCSCrypt.encodeFunc=function(data,pwd,encodeuri=true){this.pwd=pwd;var encrypt=this.encode(data);if(encodeuri){return encodeURIComponent(encrypt);}else{return encrypt;}}module.exports=TCSCrypt;